<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subnet Calculator - College of DuPage CIT</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066cc;
            --primary-dark: #0052a3;
            --secondary: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --dark: #2c3e50;
            --light: #f8f9fa;
            --cod-blue: #004b8d;
            --cod-green: #5cb85c;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2);
            animation: fadeIn 0.6s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--light);
        }

        .attribution {
            background: linear-gradient(135deg, #004b8d, #0066cc);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .attribution h2 {
            font-size: 1.5em;
            margin-bottom: 5px;
            font-weight: 600;
        }

        .attribution p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        h1 {
            color: var(--dark);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .section {
            background: var(--light);
            padding: 25px;
            border-radius: 15px;
            border: 1px solid #dee2e6;
            transition: transform 0.3s ease;
        }

        .section:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .section h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 600;
            font-size: 0.95em;
        }

        input[type="text"], input[type="number"], select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 15px;
            transition: all 0.3s ease;
            background: white;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 102, 204, 0.1);
        }

        .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 102, 204, 0.3);
        }

        .btn-secondary {
            background: var(--secondary);
            color: white;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .results {
            display: none;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .result-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .result-label {
            font-size: 0.85em;
            color: #6c757d;
            margin-bottom: 5px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-value {
            font-size: 1.3em;
            color: var(--dark);
            font-weight: bold;
            word-break: break-all;
        }

        .binary-display {
            background: #2d3748;
            color: #48bb78;
            padding: 25px;
            border-radius: 12px;
            font-family: 'Courier New', monospace;
            margin-top: 20px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .binary-row {
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
        }

        .binary-label {
            color: #cbd5e0;
            margin-right: 15px;
            min-width: 150px;
            font-weight: 600;
        }

        .binary-value {
            color: #48bb78;
            letter-spacing: 3px;
            font-size: 1.1em;
        }

        .subnet-table {
            width: 100%;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .subnet-table thead {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .subnet-table th, .subnet-table td {
            padding: 14px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .subnet-table tbody tr {
            transition: background 0.3s ease;
        }

        .subnet-table tbody tr:hover {
            background: var(--light);
        }

        .subnet-table tbody tr:last-child td {
            border-bottom: none;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid var(--danger);
            display: none;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--secondary);
        }

        .info-box {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--info);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            border-bottom: 2px solid #dee2e6;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            color: #6c757d;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: var(--primary);
        }

        .tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 2em;
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .btn-group {
                grid-template-columns: 1fr;
            }

            .tabs {
                flex-direction: column;
            }

            .binary-value {
                font-size: 0.9em;
                letter-spacing: 1px;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            padding: 8px;
            border-radius: 6px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="attribution">
            <h2>College of DuPage - CIT Department</h2>
            <p>Developed by Tony Chen</p>
        </div>

        <div class="header">
            <h1>🌐 IPv4 Subnet Calculator</h1>
            <p class="subtitle">Professional Network Planning and Subnetting Tool</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('basic')">Basic Calculator</button>
            <button class="tab" onclick="switchTab('cidr')">CIDR Calculator</button>
            <button class="tab" onclick="switchTab('subnetting')">Subnet Division</button>
        </div>

        <!-- Basic Calculator Tab -->
        <div id="basic-tab" class="tab-content active">
            <div class="main-grid">
                <div class="section">
                    <h3>📝 Network Input</h3>
                    <div class="input-group">
                        <label for="ipAddress">IP Address</label>
                        <input type="text" id="ipAddress" placeholder="192.168.1.0" value="192.168.1.0">
                    </div>
                    <div class="input-row">
                        <div class="input-group">
                            <label for="subnetMask">Subnet Mask</label>
                            <input type="text" id="subnetMask" placeholder="255.255.255.0" value="255.255.255.0">
                        </div>
                        <div class="input-group">
                            <label for="cidrInput">CIDR</label>
                            <input type="number" id="cidrInput" placeholder="24" value="24" min="0" max="32">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="calculate()">Calculate</button>
                </div>

                <div class="section">
                    <h3>📊 Quick Info</h3>
                    <div class="info-box">
                        <strong>IP Class Detection:</strong>
                        <div id="quickClass" style="margin-top: 5px;">Class C (Private)</div>
                    </div>
                    <div class="info-box">
                        <strong>Network Type:</strong>
                        <div id="networkType" style="margin-top: 5px;">Private Network (RFC 1918)</div>
                    </div>
                </div>
            </div>

            <div class="error" id="errorMsg"></div>

            <div class="results" id="basicResults">
                <div class="success">
                    ✅ Calculation complete! Network details are shown below.
                </div>

                <div class="result-grid">
                    <div class="result-card">
                        <div class="result-label">Network Address</div>
                        <div class="result-value" id="networkAddr"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Broadcast Address</div>
                        <div class="result-value" id="broadcastAddr"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Subnet Mask</div>
                        <div class="result-value" id="subnetMaskResult"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Wildcard Mask</div>
                        <div class="result-value" id="wildcardMask"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">CIDR Notation</div>
                        <div class="result-value" id="cidrNotation"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">IP Class</div>
                        <div class="result-value" id="ipClass"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Total IP Addresses</div>
                        <div class="result-value" id="totalHosts"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Usable Hosts</div>
                        <div class="result-value" id="usableHosts"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">First Usable Host</div>
                        <div class="result-value" id="firstHost"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Last Usable Host</div>
                        <div class="result-value" id="lastHost"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Network Bits</div>
                        <div class="result-value" id="networkBits"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Host Bits</div>
                        <div class="result-value" id="hostBits"></div>
                    </div>
                </div>

                <div class="binary-display">
                    <h3 style="color: #48bb78; margin-bottom: 20px;">Binary Representation</h3>
                    <div class="binary-row">
                        <span class="binary-label">IP Address:</span>
                        <span class="binary-value" id="ipBinary"></span>
                    </div>
                    <div class="binary-row">
                        <span class="binary-label">Subnet Mask:</span>
                        <span class="binary-value" id="maskBinary"></span>
                    </div>
                    <div class="binary-row">
                        <span class="binary-label">Network Address:</span>
                        <span class="binary-value" id="networkBinary"></span>
                    </div>
                    <div class="binary-row">
                        <span class="binary-label">Broadcast:</span>
                        <span class="binary-value" id="broadcastBinary"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- CIDR Calculator Tab -->
        <div id="cidr-tab" class="tab-content">
            <div class="main-grid">
                <div class="section">
                    <h3>🔢 CIDR Range Calculator</h3>
                    <div class="input-group">
                        <label for="cidrNetwork">Network Address</label>
                        <input type="text" id="cidrNetwork" placeholder="10.0.0.0" value="10.0.0.0">
                    </div>
                    <div class="input-group">
                        <label for="cidrPrefix">CIDR Prefix Length</label>
                        <input type="number" id="cidrPrefix" placeholder="8" value="8" min="0" max="32">
                    </div>
                    <button class="btn btn-primary" onclick="calculateCIDR()">Calculate CIDR</button>
                </div>

                <div class="section">
                    <h3>📈 CIDR Summary</h3>
                    <div id="cidrSummary" style="display: none;">
                        <div class="info-box">
                            <strong>Range:</strong> <span id="cidrRange"></span>
                        </div>
                        <div class="info-box">
                            <strong>Total Networks:</strong> <span id="totalNetworks"></span>
                        </div>
                        <div class="info-box">
                            <strong>Addresses per Network:</strong> <span id="addressesPerNetwork"></span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="error" id="cidrErrorMsg"></div>
            <div class="results" id="cidrResults"></div>
        </div>

        <!-- Subnet Division Tab -->
        <div id="subnetting-tab" class="tab-content">
            <div class="section">
                <h3>🔀 Network Division</h3>
                <div class="input-row">
                    <div class="input-group">
                        <label for="divNetwork">Main Network IP</label>
                        <input type="text" id="divNetwork" placeholder="172.16.0.0" value="172.16.0.0">
                    </div>
                    <div class="input-group">
                        <label for="divCidr">Network CIDR</label>
                        <input type="number" id="divCidr" placeholder="16" value="16" min="0" max="32">
                    </div>
                </div>
                <div class="input-row">
                    <div class="input-group">
                        <label for="numSubnets">Number of Subnets
                            <span class="tooltip">ℹ️
                                <span class="tooltiptext">How many equal subnets to create</span>
                            </span>
                        </label>
                        <input type="number" id="numSubnets" placeholder="4" value="4" min="2" max="256">
                    </div>
                    <div class="input-group">
                        <label for="showSubnets">Display First N Subnets</label>
                        <input type="number" id="showSubnets" placeholder="16" value="16" min="1" max="256">
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="calculateSubnets()">Calculate Subnets</button>
                    <button class="btn btn-secondary" onclick="exportSubnets()">Export Results</button>
                </div>
            </div>

            <div class="error" id="subnetErrorMsg"></div>

            <div class="results" id="subnetResults">
                <div class="result-grid" style="margin-bottom: 20px;">
                    <div class="result-card">
                        <div class="result-label">Total Subnets Created</div>
                        <div class="result-value" id="totalSubnetsCreated"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">New Subnet Mask</div>
                        <div class="result-value" id="newSubnetMask"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Hosts per Subnet</div>
                        <div class="result-value" id="hostsPerSubnet"></div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Subnet Bits Borrowed</div>
                        <div class="result-value" id="bitsBorrowed"></div>
                    </div>
                </div>

                <table class="subnet-table">
                    <thead>
                        <tr>
                            <th>Subnet #</th>
                            <th>Network Address</th>
                            <th>First Host</th>
                            <th>Last Host</th>
                            <th>Broadcast</th>
                            <th>CIDR</th>
                            <th>Usable Hosts</th>
                        </tr>
                    </thead>
                    <tbody id="subnetTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Core functions
        function ipToInt(ip) {
            const parts = ip.split('.').map(Number);
            return (parts[0] << 24) | (parts[1] << 16) | (parts[2] << 8) | parts[3];
        }

        function intToIp(int) {
            return [
                (int >>> 24) & 255,
                (int >>> 16) & 255,
                (int >>> 8) & 255,
                int & 255
            ].join('.');
        }

        function ipToBinary(ip) {
            return ip.split('.').map(octet => 
                parseInt(octet).toString(2).padStart(8, '0')
            ).join('.');
        }

        function cidrToMask(cidr) {
            const mask = 0xffffffff << (32 - cidr);
            return intToIp(mask >>> 0);
        }

        function maskToCidr(mask) {
            const parts = mask.split('.').map(Number);
            let cidr = 0;
            
            for (const part of parts) {
                if (part === 255) {
                    cidr += 8;
                } else if (part === 0) {
                    break;
                } else {
                    let temp = part;
                    while (temp & 0x80) {
                        cidr++;
                        temp <<= 1;
                    }
                    break;
                }
            }
            return cidr;
        }

        function getIpClass(ip) {
            const firstOctet = parseInt(ip.split('.')[0]);
            if (firstOctet >= 1 && firstOctet <= 126) return 'Class A';
            if (firstOctet >= 128 && firstOctet <= 191) return 'Class B';
            if (firstOctet >= 192 && firstOctet <= 223) return 'Class C';
            if (firstOctet >= 224 && firstOctet <= 239) return 'Class D (Multicast)';
            if (firstOctet >= 240 && firstOctet <= 255) return 'Class E (Reserved)';
            return 'Invalid';
        }

        function getNetworkType(ip) {
            const parts = ip.split('.').map(Number);
            const first = parts[0];
            const second = parts[1];
            
            // Private ranges
            if (first === 10) return 'Private Network (RFC 1918)';
            if (first === 172 && second >= 16 && second <= 31) return 'Private Network (RFC 1918)';
            if (first === 192 && second === 168) return 'Private Network (RFC 1918)';
            
            // Special ranges
            if (first === 127) return 'Loopback Address';
            if (first === 169 && second === 254) return 'Link-Local (APIPA)';
            if (first >= 224 && first <= 239) return 'Multicast';
            if (first >= 240) return 'Reserved';
            
            return 'Public Network';
        }

        function validateIp(ip) {
            const parts = ip.split('.');
            if (parts.length !== 4) return false;
            return parts.every(part => {
                const num = parseInt(part);
                return !isNaN(num) && num >= 0 && num <= 255;
            });
        }

        function validateSubnetMask(mask) {
            if (!validateIp(mask)) return false;
            
            const parts = mask.split('.').map(Number);
            let foundZero = false;
            
            for (const part of parts) {
                if (foundZero && part !== 0) return false;
                
                if (part !== 255) {
                    foundZero = true;
                    const validOctets = [0, 128, 192, 224, 240, 248, 252, 254, 255];
                    if (!validOctets.includes(part)) return false;
                }
            }
            return true;
        }

        function updateQuickInfo() {
            const ip = document.getElementById('ipAddress').value.trim();
            if (validateIp(ip)) {
                document.getElementById('quickClass').textContent = getIpClass(ip);
                document.getElementById('networkType').textContent = getNetworkType(ip);
            }
        }

        function updateMaskFromCidr() {
            const cidr = parseInt(document.getElementById('cidrInput').value);
            if (!isNaN(cidr) && cidr >= 0 && cidr <= 32) {
                document.getElementById('subnetMask').value = cidrToMask(cidr);
            }
        }

        function updateCidrFromMask() {
            const mask = document.getElementById('subnetMask').value.trim();
            if (validateSubnetMask(mask)) {
                document.getElementById('cidrInput').value = maskToCidr(mask);
            }
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'basic') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('basic-tab').classList.add('active');
            } else if (tab === 'cidr') {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('cidr-tab').classList.add('active');
            } else if (tab === 'subnetting') {
                document.querySelectorAll('.tab')[2].classList.add('active');
                document.getElementById('subnetting-tab').classList.add('active');
            }
        }

        function calculate() {
            const errorDiv = document.getElementById('errorMsg');
            const resultsDiv = document.getElementById('basicResults');
            errorDiv.style.display = 'none';
            
            const ipInput = document.getElementById('ipAddress').value.trim();
            const subnetMask = document.getElementById('subnetMask').value.trim();
            
            if (!validateIp(ipInput)) {
                errorDiv.textContent = '❌ Invalid IP address format';
                errorDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                return;
            }
            
            if (!validateSubnetMask(subnetMask)) {
                errorDiv.textContent = '❌ Invalid subnet mask format';
                errorDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                return;
            }
            
            const cidr = maskToCidr(subnetMask);
            const ipInt = ipToInt(ipInput);
            const maskInt = ipToInt(subnetMask);
            const networkInt = (ipInt & maskInt) >>> 0;
            const broadcastInt = (networkInt | ~maskInt) >>> 0;
            const wildcardInt = ~maskInt >>> 0;
            
            const totalHosts = Math.pow(2, 32 - cidr);
            const usableHosts = totalHosts > 2 ? totalHosts - 2 : totalHosts === 2 ? 0 : 1;
            
            const networkAddr = intToIp(networkInt);
            const broadcastAddr = intToIp(broadcastInt);
            const wildcardMask = intToIp(wildcardInt);
            
            let firstHost = networkAddr;
            let lastHost = broadcastAddr;
            
            if (cidr < 31) {
                firstHost = intToIp(networkInt + 1);
                lastHost = intToIp(broadcastInt - 1);
            } else if (cidr === 31) {
                firstHost = networkAddr;
                lastHost = broadcastAddr;
            }
            
            // Update results
            document.getElementById('networkAddr').textContent = networkAddr;
            document.getElementById('broadcastAddr').textContent = broadcastAddr;
            document.getElementById('subnetMaskResult').textContent = subnetMask;
            document.getElementById('wildcardMask').textContent = wildcardMask;
            document.getElementById('cidrNotation').textContent = `/${cidr}`;
            document.getElementById('ipClass').textContent = getIpClass(ipInput);
            document.getElementById('totalHosts').textContent = totalHosts.toLocaleString();
            document.getElementById('usableHosts').textContent = usableHosts.toLocaleString();
            document.getElementById('firstHost').textContent = firstHost;
            document.getElementById('lastHost').textContent = lastHost;
            document.getElementById('networkBits').textContent = cidr;
            document.getElementById('hostBits').textContent = 32 - cidr;
            
            // Update binary display
            document.getElementById('ipBinary').textContent = ipToBinary(ipInput);
            document.getElementById('maskBinary').textContent = ipToBinary(subnetMask);
            document.getElementById('networkBinary').textContent = ipToBinary(networkAddr);
            document.getElementById('broadcastBinary').textContent = ipToBinary(broadcastAddr);
            
            resultsDiv.style.display = 'block';
        }

        function calculateCIDR() {
            const errorDiv = document.getElementById('cidrErrorMsg');
            const resultsDiv = document.getElementById('cidrResults');
            const summaryDiv = document.getElementById('cidrSummary');
            errorDiv.style.display = 'none';
            
            const network = document.getElementById('cidrNetwork').value.trim();
            const prefix = parseInt(document.getElementById('cidrPrefix').value);
            
            if (!validateIp(network)) {
                errorDiv.textContent = '❌ Invalid network address';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (isNaN(prefix) || prefix < 0 || prefix > 32) {
                errorDiv.textContent = '❌ Invalid CIDR prefix (0-32)';
                errorDiv.style.display = 'block';
                return;
            }
            
            const networkInt = ipToInt(network);
            const mask = cidrToMask(prefix);
            const maskInt = ipToInt(mask);
            const actualNetwork = (networkInt & maskInt) >>> 0;
            const broadcast = (actualNetwork | ~maskInt) >>> 0;
            
            const totalAddresses = Math.pow(2, 32 - prefix);
            const totalPossibleNetworks = Math.pow(2, prefix);
            
            document.getElementById('cidrRange').textContent = 
                `${intToIp(actualNetwork)} - ${intToIp(broadcast)}`;
            document.getElementById('totalNetworks').textContent = 
                totalPossibleNetworks.toLocaleString();
            document.getElementById('addressesPerNetwork').textContent = 
                totalAddresses.toLocaleString();
            
            summaryDiv.style.display = 'block';
            
            // Create detailed results
            const html = `
                <div class="success">✅ CIDR calculation complete!</div>
                <div class="result-grid">
                    <div class="result-card">
                        <div class="result-label">Network</div>
                        <div class="result-value">${intToIp(actualNetwork)}/${prefix}</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Subnet Mask</div>
                        <div class="result-value">${mask}</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">First IP</div>
                        <div class="result-value">${intToIp(actualNetwork)}</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label">Last IP</div>
                        <div class="result-value">${intToIp(broadcast)}</div>
                    </div>
                </div>
            `;
            
            resultsDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
        }

        function calculateSubnets() {
            const errorDiv = document.getElementById('subnetErrorMsg');
            const resultsDiv = document.getElementById('subnetResults');
            errorDiv.style.display = 'none';
            
            const network = document.getElementById('divNetwork').value.trim();
            const cidr = parseInt(document.getElementById('divCidr').value);
            const numSubnets = parseInt(document.getElementById('numSubnets').value);
            const showSubnets = parseInt(document.getElementById('showSubnets').value);
            
            if (!validateIp(network)) {
                errorDiv.textContent = '❌ Invalid network address';
                errorDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                return;
            }
            
            if (isNaN(cidr) || cidr < 0 || cidr > 32) {
                errorDiv.textContent = '❌ Invalid CIDR (0-32)';
                errorDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                return;
            }
            
            // Calculate required subnet bits
            const subnetBits = Math.ceil(Math.log2(numSubnets));
            const newCidr = cidr + subnetBits;
            
            if (newCidr > 30) {
                errorDiv.textContent = '❌ Too many subnets for available address space';
                errorDiv.style.display = 'block';
                resultsDiv.style.display = 'none';
                return;
            }
            
            const totalSubnets = Math.pow(2, subnetBits);
            const hostsPerSubnet = Math.pow(2, 32 - newCidr) - 2;
            
            // Update summary
            document.getElementById('totalSubnetsCreated').textContent = totalSubnets;
            document.getElementById('newSubnetMask').textContent = 
                `${cidrToMask(newCidr)} (/${newCidr})`;
            document.getElementById('hostsPerSubnet').textContent = hostsPerSubnet.toLocaleString();
            document.getElementById('bitsBorrowed').textContent = subnetBits;
            
            // Generate subnet table
            const tbody = document.getElementById('subnetTableBody');
            tbody.innerHTML = '';
            
            const networkInt = ipToInt(network);
            const increment = Math.pow(2, 32 - newCidr);
            const subnetsToShow = Math.min(showSubnets, totalSubnets);
            
            for (let i = 0; i < subnetsToShow; i++) {
                const subnetInt = (networkInt + (i * increment)) >>> 0;
                const broadcastInt = (subnetInt + increment - 1) >>> 0;
                const firstHostInt = subnetInt + 1;
                const lastHostInt = broadcastInt - 1;
                
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${i + 1}</td>
                    <td>${intToIp(subnetInt)}</td>
                    <td>${intToIp(firstHostInt)}</td>
                    <td>${intToIp(lastHostInt)}</td>
                    <td>${intToIp(broadcastInt)}</td>
                    <td>/${newCidr}</td>
                    <td>${hostsPerSubnet.toLocaleString()}</td>
                `;
            }
            
            resultsDiv.style.display = 'block';
        }

        function exportSubnets() {
            const rows = document.querySelectorAll('#subnetTableBody tr');
            if (rows.length === 0) {
                alert('Please calculate subnets first');
                return;
            }
            
            let csv = 'Subnet#,Network Address,First Host,Last Host,Broadcast,CIDR,Usable Hosts\n';
            rows.forEach(row => {
                const cells = row.getElementsByTagName('td');
                const rowData = Array.from(cells).map(cell => cell.textContent).join(',');
                csv += rowData + '\n';
            });
            
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'subnet_division.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Event listeners
        document.getElementById('ipAddress').addEventListener('input', updateQuickInfo);
        document.getElementById('subnetMask').addEventListener('input', updateCidrFromMask);
        document.getElementById('cidrInput').addEventListener('input', updateMaskFromCidr);
        
        document.getElementById('ipAddress').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calculate();
        });
        document.getElementById('subnetMask').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calculate();
        });
        document.getElementById('cidrInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calculate();
        });

        // Initialize
        updateQuickInfo();
        calculate();
    </script>
</body>
</html>